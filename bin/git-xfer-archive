#!/usr/bin/env sh
#
# archive xfer set of files (including directory structure)
# 
# @author <bprinty@gmail.com>
# ------------------------------------------------


# meta
# ----
usage() {
    echo "usage: git xfer archive [options] <name> [<filelist>]"
    echo ""
    echo "Options:"
    echo "  -h | --help              Show help and exit."
}


# exec
# ----
xrun() {
    if [ "$#" -lt 1 ]; then
        usage; exit 1
    fi

    exclude="52dbb9dc-d40c-11e5-84fd-7831c1b99ad4"
    case "$1" in
        "-h"|"--help")
            usage; exit 0
            ;;
        "-x"|"--exclude")
            exclude="$2"; shift; shift
            ;;
    esac

    archive="$1"
    if [ ! "$archive" ]; then
        usage; exit 1
    fi

    # add files to be archived
    tarlist="$cache"
    if [ ! -z $2 ]; then
        if [ ! -e "$2" ]; then
            echo 'Specified list of files to archive does not exist!'
            exit 1
        fi
        tarlist="$2"
    fi

    # archive and save to specified file
    fullpath=$(cd "$(dirname $archive)" && pwd -P)/$(basename "$archive")
    cd "$base"
    tar -cvf "$fullpath.tar" -T "$tarlist" 2>/dev/null
    gzip "$fullpath.tar"

    exit 0
}
